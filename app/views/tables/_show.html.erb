<div class="row">
	<div class="col-md-12 panel panel-default turnInfo">
  		<div class="row panel-body text-center">
  			<div class="col-xs-12">
    			<% if @game && current_user.player %>
						<% if current_user.username == @game.mover.user.username %>
							<% if current_user.username == @game.attacker.user.username %>				
								<span>Your attack!</span>
							<% elsif current_user.username == @game.defender.user.username %>
								<span>Your defence!</span>
							<% end %>
						<% else %>
							<% if current_user.username == @game.attacker.user.username %>				
								<span>Opponent`s defence!</span>
							<% elsif current_user.username == @game.defender.user.username %>
								<span>Opponent`s attack!</span>	
							<% end %>
						<% end %>
				<% end %>

				<span class="pull-right" id="turnInfoButton">
					<span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
				</span>

				<% if @game.deck %>
					<div class="hide" id="turnInfoHint">
						<span>Trump: <%= make_suite (@game.deck.trump) %></span> <br />
						<span>Cards left: <%= @game.deck.deck_cards.length - @game.deck.cursor %></span>
					</div>
				<% end %>
			</div>
 		</div>
	</div>
</div>
<div class="row">
	<div class='col-md-12 yieldcontent'>
		<% if current_user %>	
			<% if current_user.view_theme == nil %>
				<% tableStyle = "tableClassic" %>
			<% elsif current_user.view_theme %>
				<% tableStyle = "table#{current_user.view_theme.to_s}" %>
			<% else %>
				<% tableStyle = "tableClassic" %>
			<% end %>
		<% else %>
				<% tableStyle = "tableClassic" %>
		<% end %>
	
		<div class="row <%= "#{tableStyle}" %> ">
				<div id="table_row_game" class="row">
					<div id="table_cards" class="col-xs-10">
						<%= render partial: 'tables/table' %>
					</div>
					<% if @game.deck %>
						<div id="table_deck" class="col-xs-2">
							<%= render partial: 'tables/table_deck' %>
						</div>
					<% else %>
						<div id="table_deck" class="col-xs-2">
						</div>
					<% end %>
				</div>
				<div id="table_row_player" class="row">
					<div id="table_player_cards" class="col-xs-10">
						<%= render partial: 'tables/table_player_cards'%>
					</div>
					<div id="table_controls" class="col-xs-2">
						<%= link_to end_turn_url, remote: true, :method => :post do%>
							<div  class="table_button">
								<span class="glyphicon glyphicon-repeat" aria-hidden="true">&nbsp;</span><span>End&nbsp;Turn</span>
							</div>
						<% end %>
						<%= link_to end_game_url, :method => :post do %>
							<div class="table_button">
								<span class="glyphicon glyphicon-flag" aria-hidden="true">&nbsp;</span><span>End&nbsp;Game</span>
							</div>
						<% end %>
						<div>
							<%= link_to 'Reload', url: url_for( :controller => :games, :action => :show ), remote: true, :method => :get, :class => "btn btn-default" %>
						</div>
					</div>
				</div>
		</div>
	</div>
</div>


<% content_for :show do %>
  <script type="text/javascript">
    $(document).ready(function () {
   		setInterval(function(){
		refreshPartial();
		}, 5000); 
	});

	function refreshPartial() {
  		$.ajax({
          	url: "<%= @game %>",
          	dataType: "script" 
 		})
	};
  </script>
<% end %>